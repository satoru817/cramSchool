<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${isEdit ? 'テスト編集フォーム' : 'テスト登録フォーム'}"></title>
    <div th:replace="~{fragment::head}"></div>
</head>
<body>
<div th:replace="~{fragment::header}"></div>

<div class="container mt-4 justify-content-center align-items-center min-vh-100">
    <h2 class="mb-4" th:text="${isEdit ?
            (regularTestSet.term + '年度 ' + regularTest.getSchool().getName() + regularTestSet.grade + '学年 ' + regularTestSet.semester + '学期 ' + (regularTestSet.isMid == 1 ? '中間' : '期末')) :
            'テスト登録フォーム'}"></h2>

    <form th:action="${'/updateRegularTest/' + regularTestId }" method="post" th:object="${regularTestForm}">
        <div class="form-group">
            <label for="date">実施日</label>
            <input type="date" class="form-control" th:field="*{date}" required style="width: 50%;">
        </div>

        <h3 class="mt-4">科目別満点</h3>
        <div class="row">
            <div class="col-md-4 form-group">
                <label for="japanese">国語</label>
                <input type="number" class="form-control" th:field="*{japanese}" th:value="${regularTestForm.japanese != null ? regularTestForm.japanese : 100}" min="0" required>
            </div>
            <div class="col-md-4 form-group">
                <label for="math">数学</label>
                <input type="number" class="form-control" th:field="*{math}" th:value="${regularTestForm.math != null ? regularTestForm.math : 100}" min="0" required>
            </div>
            <div class="col-md-4 form-group">
                <label for="english">英語</label>
                <input type="number" class="form-control" th:field="*{english}" th:value="${regularTestForm.english != null ? regularTestForm.english : 100}" min="0" required>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 form-group">
                <label for="science">理科</label>
                <input type="number" class="form-control" th:field="*{science}" th:value="${regularTestForm.science != null ? regularTestForm.science : 100}" min="0" required>
            </div>
            <div class="col-md-4 form-group">
                <label for="social">社会</label>
                <input type="number" class="form-control" th:field="*{social}" th:value="${regularTestForm.social != null ? regularTestForm.social : 100}" min="0" required>
            </div>
            <div class="col-md-4 form-group">
                <label for="music">音楽</label>
                <input type="number" class="form-control" th:field="*{music}" th:value="${regularTestForm.music != null ? regularTestForm.music : 100}" min="0" required>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 form-group">
                <label for="art">美術</label>
                <input type="number" class="form-control" th:field="*{art}" th:value="${regularTestForm.art != null ? regularTestForm.art : 100}" min="0" required>
            </div>
            <div class="col-md-4 form-group">
                <label for="tech">技術</label>
                <input type="number" class="form-control" th:field="*{tech}" th:value="${regularTestForm.tech != null ? regularTestForm.tech : 100}" min="0" required>
            </div>
            <div class="col-md-4 form-group">
                <label for="pe">体育</label>
                <input type="number" class="form-control" th:field="*{pe}" th:value="${regularTestForm.pe != null ? regularTestForm.pe : 100}" min="0" required>
            </div>
        </div>

        <button class="btn btn-warning" th:if="${isEdit}" type="submit">編集結果登録</button>
    </form>

    <form th:action="${'/updateRegularTest/average/' + regularTestId }" method="post" th:object="${regularTestResult}">
        <hr>
        <h3 class="mt-4">平均点登録</h3>
        <input type="hidden" th:field="*{id}">
        <div class="row">
            <div class="col-md-4 form-group">
                <label for="japaneseAvg">国語</label>
                <input type="number" class="form-control" th:field="*{japanese}" th:value="${regularTestResult.japanese != null ? regularTestResult.japanese : 0}" min="0">
            </div>
            <div class="col-md-4 form-group">
                <label for="mathAvg">数学</label>
                <input type="number" class="form-control" th:field="*{math}" th:value="${regularTestResult.math != null ? regularTestResult.math : 0}" min="0">
            </div>
            <div class="col-md-4 form-group">
                <label for="englishAvg">英語</label>
                <input type="number" class="form-control" th:field="*{english}" th:value="${regularTestResult.english != null ? regularTestResult.english : 0}" min="0">
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 form-group">
                <label for="scienceAvg">理科</label>
                <input type="number" class="form-control" th:field="*{science}" th:value="${regularTestResult.science != null ? regularTestResult.science : 0}" min="0">
            </div>
            <div class="col-md-4 form-group">
                <label for="socialAvg">社会</label>
                <input type="number" class="form-control" th:field="*{social}" th:value="${regularTestResult.social != null ? regularTestResult.social : 0}" min="0">
            </div>
            <div class="col-md-4 form-group">
                <label for="musicAvg">音楽</label>
                <input type="number" class="form-control" th:field="*{music}" th:value="${regularTestResult.music != null ? regularTestResult.music : 0}" min="0">
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 form-group">
                <label for="artAvg">美術</label>
                <input type="number" class="form-control" th:field="*{art}" th:value="${regularTestResult.art != null ? regularTestResult.art : 0}" min="0">
            </div>
            <div class="col-md-4 form-group">
                <label for="techAvg">技術</label>
                <input type="number" class="form-control" th:field="*{tech}" th:value="${regularTestResult.tech != null ? regularTestResult.tech : 0}" min="0">
            </div>
            <div class="col-md-4 form-group">
                <label for="peAvg">体育</label>
                <input type="number" class="form-control" th:field="*{pe}" th:value="${regularTestResult.pe != null ? regularTestResult.pe : 0}" min="0">
            </div>
        </div>

        <button class="btn btn-warning" type="submit">平均点登録</button>
    </form>
</div>

<div th:replace="~{fragment::footer}"></div>
<div th:replace="~{fragment::script}"></div>
</body>
</html>
